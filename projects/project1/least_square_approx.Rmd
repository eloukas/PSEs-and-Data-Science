---
title: "Least Squares Approximation"
output: html_notebook
---



```{r}
library("MASS")
data = read.table("data.txt")
data = as.matrix(data)
```

# Least Square Approx
```{r}
x = as.matrix(data[,1])
y = as.matrix(data[,2])
phi = matrix(c(x^0,x^1), nrow=dim(data)[1], ncol=dim(data)[2])
w = ginv(phi)%*%y
plot(x,y)
y_approx = phi%*%w
lines(x,y_approx,col="green")
```

# Square Test
```{r}
y_mean = mean(y)
x_mean = mean(x)

SStot = sum((y-y_mean)**2)
SSres = sum((y-y_approx)**2)
r = 1 - (SSres/SStot)
```

# Cross-validation
```{r}
fold = 8
indexes = as.matrix(order(x))
n = dim(x)[1]/fold

for (i in 1:8){
  test_set_x = x[indexes[(i-1)*n+1:i*n]]
}
```